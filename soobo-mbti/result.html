<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>수면 MBTI 검사 결과</title>
    <link rel="stylesheet" href="style.css">
</head>
<body data-kakao-app-key="93298b5c87e46c48f2ba181afb1d27fd">
    <div class="mobile-container">
        <h3 id="result-type">당신의 유형은...</h3>
        <h1 id="result-name">결과 이름</h1>
        <img id="result-img" src="" alt="결과 이미지">
        <p id="result-desc">결과에 대한 설명이 여기에 표시됩니다.</p>
        <div class="button-container">
            <button id="retry-btn" onclick="retryTest()">다시 테스트하기</button>
            <button id="share-btn" onclick="shareResult()">공유하기</button>
        </div>
    </div>

    <div id="share-overlay" class="modal-overlay" hidden></div>
    <div id="share-sheet" class="bottom-sheet" aria-hidden="true">
        <div class="sheet-handle"></div>
        <div class="sheet-title">공유하기</div>
        <div class="share-grid">
            <button class="share-item" data-share="kakao">카카오톡</button>
            <button class="share-item" data-share="instagram">인스타그램</button>
            <button class="share-item" data-share="copy">링크 복사</button>
        </div>
        <button id="share-cancel" class="sheet-cancel">취소</button>
    </div>
</body>
</html>

<script>
    // --- 결과 데이터 ---
    // 모든 16가지 유형에 대한 데이터를 준비합니다.
    let mbtiList = []; // JSON 데이터를 저장할 빈 배열

    // fetch를 사용해 JSON 파일 불러오기
    function loadMbtiList() {
        return fetch('./mbti.json') // 1. JSON 파일 요청
            .then(response => response.json()) // 2. 응답을 JSON으로 파싱
            .then(data => {
                mbtiList = data; // 3. 파싱된 데이터를 qnaList에 저장
            })
            .catch(error => console.error('Error loading MBTI List data:', error));
    }

    // 페이지가 로드될 때 실행되는 함수
    window.onload = function() {
        loadMbtiList().then(() => {
            // URL에서 'mbti' 쿼리 파라미터 값 가져오기
            const urlParams = new URLSearchParams(window.location.search);
            const mbtiResult = urlParams.get('mbti');
            
            if (mbtiResult && mbtiList[mbtiResult]) {
                const resultData = mbtiList[mbtiResult];
                
                // HTML 요소에 결과 데이터 채우기
                document.getElementById('result-type').textContent = `당신의 유형은 ${mbtiResult}`;
                document.getElementById('result-name').textContent = resultData.name;
                document.getElementById('result-img').src = resultData.img;
                document.getElementById('result-img').alt = resultData.name;
                document.getElementById('result-desc').textContent = resultData.desc;
            } else {
                // 유효하지 않은 mbti 값일 경우 기본 메시지 표시
                document.getElementById('result-name').textContent = '결과를 찾을 수 없습니다.';
                document.getElementById('result-desc').textContent = '테스트를 다시 시작해주세요.';
            }
        });
    };

    // '다시 검사하기' 버튼 클릭 시 index.html로 이동
    function retryTest() {
        window.location.href = 'index.html';
    }
</script>

<script src="./share.js"></script>